# ğŸ”— PodLink - Mental Health & Accountability Platform# ğŸ”— PodLink - Mental Health & Accountability Platform



> **Connect. Support. Grow Together.** A modern web application that connects individuals in small accountability groups (pods) to achieve personal growth goals through peer support, AI guidance, and real-time communication.> A modern web application that connects individuals in small accountability groups (pods) to achieve personal growth goals through peer support, daily check-ins, crisis intervention, and real-time communication.



[![Next.js](https://img.shields.io/badge/Next.js-16.0.7-black?style=for-the-badge&logo=next.js&logoColor=white)](https://nextjs.org/)[![Next.js](https://img.shields.io/badge/Next.js-16.0.5-black?style=for-the-badge&logo=next.js)](https://nextjs.org/)

[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-3178C6?style=for-the-badge&logo=typescript&logoColor=white)](https://www.typescriptlang.org/)[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue?style=for-the-badge&logo=typescript)](https://www.typescriptlang.org/)

[![Prisma](https://img.shields.io/badge/Prisma-6.18-2D3748?style=for-the-badge&logo=prisma&logoColor=white)](https://www.prisma.io/)[![Prisma](https://img.shields.io/badge/Prisma-6.18-2D3748?style=for-the-badge&logo=prisma)](https://www.prisma.io/)

[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-Neon-336791?style=for-the-badge&logo=postgresql&logoColor=white)](https://neon.tech/)[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-Neon-336791?style=for-the-badge&logo=postgresql)](https://neon.tech/)

[![Socket.io](https://img.shields.io/badge/Socket.io-4.8-010101?style=for-the-badge&logo=socket.io&logoColor=white)](https://socket.io/)[![Socket.io](https://img.shields.io/badge/Socket.io-4.8-010101?style=for-the-badge&logo=socket.io)](https://socket.io/)

[![Tailwind CSS](https://img.shields.io/badge/Tailwind-3.4-38B2AC?style=for-the-badge&logo=tailwind-css&logoColor=white)](https://tailwindcss.com/)[![OpenRouter](https://img.shields.io/badge/OpenRouter-AI-purple?style=for-the-badge)](https://openrouter.ai/)

[![License](https://img.shields.io/badge/License-MIT-green.svg?style=for-the-badge)](LICENSE)

---

---

## ğŸ“‹ Table of Contents

## ğŸ“– Table of Contents

- [Overview](#-overview)

- [About](#-about)- [Core Features](#-core-features)

- [Features](#-features)- [Technology Stack](#-technology-stack)

- [Technology Stack](#-technology-stack)- [Prerequisites](#-prerequisites)

- [Prerequisites](#-prerequisites)- [Installation](#-installation)

- [Installation](#-installation)- [Environment Setup](#-environment-setup)

- [Environment Variables](#-environment-variables)- [Database Setup](#-database-setup)

- [Database Setup](#-database-setup)- [Running the Application](#-running-the-application)

- [Running the Application](#-running-the-application)- [Project Structure](#-project-structure)

- [Project Structure](#-project-structure)- [API Documentation](#-api-documentation)

- [API Documentation](#-api-documentation)- [AI Integration](#-ai-integration)

- [Deployment](#-deployment)- [Deployment](#-deployment)

- [Contributing](#-contributing)- [Troubleshooting](#-troubleshooting)

- [License](#-license)

- [Support](#-support)---



---## ğŸ¯ Overview



## ğŸ¯ About**PodLink** is a mental health and accountability platform that helps individuals achieve their personal goals through structured peer support and AI-assisted guidance.



**PodLink** is a mental health and accountability platform designed to help individuals achieve their personal goals through structured peer support and AI-assisted guidance. Whether you're quitting a bad habit or building a new one, PodLink connects you with like-minded individuals in small, supportive groups called "pods."### What Makes PodLink Unique?



### ğŸŒŸ What Makes PodLink Special?- **AI-Powered Pod Matching**: Smart algorithm groups users (4-6 members) based on goal similarity, timezone, and compatibility

- **Real-Time Presence**: Live online/offline status tracking for all pod members

- **ğŸ¤– AI-Powered Matching**: Smart algorithm creates compatible 4-6 member pods based on goals, timezones, and availability- **Crisis Support System**: Immediate help system with AI companion and peer notifications

- **ğŸ’¬ Real-Time Communication**: WhatsApp-style chat with Socket.IO for instant messaging, typing indicators, and read receipts- **Dynamic AI Generation**: All names, responses, and content generated via OpenRouter API (no static content)

- **ğŸ”´ Live Presence Tracking**: See who's online in your pod in real-time- **Privacy-First**: Anonymous display names protect user identity

- **ğŸš¨ Crisis Support System**: Immediate help with AI companion and instant peer notifications- **Streak Gamification**: Daily check-ins with streak counters and restoration system

- **ğŸ­ Privacy-First**: Anonymous display names generated by AI protect your identity

- **ğŸ”¥ Streak Gamification**: Daily check-ins with streak counters, leaderboards, and restoration system### Target Audience

- **ğŸ›¡ï¸ Content Moderation**: AI-powered filtering prevents harmful content before it's sent

- **ğŸ“§ Email Verification**: Secure authentication with verified email addresses- Individuals overcoming addictions (smoking, alcohol, social media, etc.)

- **ğŸ¨ Modern UI**: Beautiful, responsive design with dark mode support- People building healthy habits (exercise, meditation, healthy eating)

- Professionals seeking accountability for personal development

### ğŸ‘¥ Who Is It For?- Anyone needing structured peer support for mental health goals



- Individuals overcoming addictions (smoking, alcohol, gaming, social media)## âœ¨ Core Features

- People building healthy habits (exercise, meditation, reading, healthy eating)

- Professionals seeking accountability for personal development### ğŸ” Authentication & Security

- Anyone needing structured peer support for mental health goals- **Multi-Provider Authentication**

  - Email/Password with bcrypt hashing

---  - Google OAuth 2.0 integration

  - NextAuth.js JWT session management

## âœ¨ Features  - Protected route middleware

- **Onboarding Workflow**

### ğŸ” Authentication & Onboarding  - Goal type selection (Quit Habit / Build Habit)

  - Goal category with AI-generated suggestions

- **Multi-Provider Authentication**  - Availability schedule configuration

  - âœ… Email/Password with bcrypt hashing (256-bit)  - **AI-Generated Display Names** (OpenRouter API - dynamic, no static fallbacks)

  - âœ… Google OAuth 2.0 integration  - Avatar upload via Cloudinary (2MB limit)

  - âœ… Email verification with token-based system

  - âœ… NextAuth.js JWT session management### ğŸ‘¥ Smart Pod System

  - âœ… Protected routes with middleware- **AI-Powered Matching Algorithm**

  - âœ… Rate limiting (5 signups/hour, 10 logins/15min)  - Groups 4-6 users based on:

  - âœ… reCAPTCHA v2 protection on registration    - Goal type and category similarity

    - Timezone compatibility (Â±3 hours)

- **Smart Onboarding Flow**    - Availability schedule overlap

  - Goal type selection (Quit Habit / Build Habit)  - **Dynamic Pod Names** (OpenRouter API - category-specific generation)

  - AI-generated goal category suggestions  - AI bots auto-fill demo/incomplete pods

  - Availability schedule configuration (timezone-aware)- **Pod Features**

  - AI-generated anonymous display names for privacy  - **Real-Time Online/Offline Status** (Socket.IO presence tracking)

  - Avatar upload via Cloudinary (max 2MB, auto-optimization)  - Live member count and online indicators (green/gray dots)

  - Personalized welcome experience  - Current streak display for each member

  - Total pod streak calculation

### ğŸ‘¥ Pod System  - Connection status badge (Connecting/Connected/Disconnected)



- **AI-Powered Pod Matching**### ğŸ’¬ Real-Time Chat System

  - Groups 4-6 users based on:- **WhatsApp-Style Messaging**

    - Goal type and category similarity  - Socket.IO bidirectional communication (ports 3001, 3002)

    - Timezone compatibility (Â±3 hours)  - Live message delivery with instant updates

    - Availability schedule overlap  - Emoji picker (emoji-picker-react)

  - Dynamic pod names generated by OpenRouter API  - Image sharing (Cloudinary upload, max 5MB)

  - AI bots fill incomplete pods for demos  - Full-size image preview modal

  - Automatic pod rebalancing  - Message reactions with emoji

  - Typing indicators (3-user limit display)

- **Pod Features**  - Read receipts (âœ“âœ“ checkmarks)

  - Real-Time Online Status with green/gray indicators- **Content Moderation**

  - Live member count with connection status  - **AI-Powered Moderation** (OpenRouter API + fallback patterns)

  - Current streak display for each member  - Blocks offensive content pre-send (400 error response)

  - Total pod streak calculation and rankings  - Detects: racial slurs, profanity, hate speech, harassment

  - Pod statistics and analytics  - 20+ keyword patterns with critical/high severity flags

  - Auto-deletes messages after 3 user reports

### ğŸ’¬ Real-Time Chat  - Temperature 0.1 for strict AI moderation

- **Chat Features**

- **WhatsApp-Style Messaging**  - Date separators for organization

  - Socket.IO bidirectional communication  - Auto-scroll to latest message

  - Instant message delivery with live updates  - Crisis response tagging

  - Full emoji picker with 1000+ emojis  - Message reporting system

  - Image sharing (Cloudinary, max 5MB)  - Image preview before upload

  - Message reactions with emoji support

  - Typing indicators (max 3 users shown)### ğŸ“Š Streak & Check-In System

  - Read receipts (âœ“âœ“ blue checkmarks)- **Daily Accountability Tracking**

  - Date separators and auto-scroll  - Timezone-aware check-in system

  - Consecutive day streak counter

- **AI-Powered Content Moderation**  - Weekly progress visualization

  - OpenRouter API + pattern matching  - Check-in history API

  - Blocks offensive content before sending- **Streak Management**

  - Auto-deletes messages after 3 reports  - Auto-breaks streaks for missed days (midnight reset)

  - Real-time moderation feedback  - **Streak Restoration** (1 per month, restores to previous streak)

  - Last successful day tracking

### ğŸ”¥ Engagement & Gamification  - Grace period handling



- **Daily Check-Ins**### ğŸ†˜ Crisis Support Toolkit

  - Modal prompt every 24 hours- **Emergency Alert System**

  - Mood selector and progress notes  - One-click crisis alert broadcasts to pod

  - Automatic streak increment  - Real-time notification to all online members

  - AI-generated motivational responses  - Optional custom help message

  - **AI-Generated Automated Responses** (OpenRouter API for offline members >6 hours)

- **Streak System**  - Alert resolution tracking

  - Daily streak counter with fire emoji ğŸ”¥  - Crisis state management

  - Longest streak tracking- **Personal Crisis Toolkit**

  - Streak restoration (1 per 30 days)  - Customizable coping strategies

  - Automated midnight UTC reset  - Drag-and-drop reordering (react-beautiful-dnd)

  - Visual streak calendar  - CRUD operations for toolkit items

  - Quick access during emergencies

- **Leaderboard**  - Shareable with pod members

  - Real-time rankings by current streak

  - Top 100 users displayed### ğŸ† Gamification & Leaderboards

  - Pod-based leaderboards- **Ranking System**

  - Weekly/monthly/all-time views  - Top pods by total combined streak

  - Top individuals by current streak

### ğŸš¨ Crisis Support Toolkit  - Real-time ranking updates

  - Weekly/monthly/all-time filters

- Breathing exercises with visual guides- **Achievement Badges**

- AI-powered crisis companion chatbot  - 7-Day Streak badge

- Emergency contact quick-dial  - 30-Day Streak badge

- Grounding techniques (5-4-3-2-1 method)  - Instant Responder (crisis support <5 min)

- Positive affirmations generator  - Pod Champion (most active member)

- Crisis hotline directory

- Peer notification system### ğŸ¤– AI Integration (OpenRouter API)

- **Fully Dynamic AI Generation**

---  - **Primary**: OpenRouter API (4 free models)

    - `google/gemini-2.0-flash-exp:free`

## ğŸ› ï¸ Technology Stack    - `meta-llama/llama-3.2-3b-instruct:free`

    - `microsoft/phi-3-mini-128k-instruct:free`

### Frontend    - `qwen/qwen-2-7b-instruct:free`

- **Framework**: Next.js 16.0.7 (App Router, React Server Components)  - **Fallback**: Google Gemini 2.0 Flash (50/50 hybrid for chat)

- **Language**: TypeScript 5.0  - **Use Cases**:

- **Styling**: Tailwind CSS 3.4 + shadcn/ui    - Anonymous display name generation (temperature 0.9)

- **UI Components**: Radix UI primitives    - Pod name generation (category-specific context)

- **Forms**: React Hook Form + Zod validation    - Crisis response messages (user context: streak, goal, crisis state)

    - Content moderation (temperature 0.1, strict prompts)

### Backend    - Supportive pod messages (AI bot members)

- **Runtime**: Node.js 20+- **No Static Content**: All names, responses, and suggestions dynamically generated

- **API**: Next.js API Routes (REST)

- **Authentication**: NextAuth.js 5.0-beta### ğŸ“± Modern UI/UX

- **Database ORM**: Prisma 6.18- **Responsive Design**

- **Database**: Neon PostgreSQL (serverless)  - Mobile-first approach (375px+)

- **Real-Time**: Socket.IO 4.8 (WebSocket)  - Tablet optimized (768px+)

- **Email**: Nodemailer (SMTP)  - Desktop support (1024px+)

- **File Upload**: Cloudinary  - Touch-friendly interactions

- **Component Library**

### AI & Services  - shadcn/ui for accessible components

- **AI API**: OpenRouter (multiple model support)  - Tailwind CSS utility-first styling

- **OAuth**: Google OAuth 2.0  - Framer Motion animations

- **Security**: reCAPTCHA v2, bcrypt, rate limiting  - Lucide React icons

- **Cron Jobs**: Vercel Cron (daily streak reset)  - Custom theme system

---

---

## ğŸ› ï¸ Technology Stack

## ğŸ“‹ Prerequisites

### Frontend

Before you begin, ensure you have:

| Technology | Version | Purpose |

- **Node.js**: v20.0.0 or higher|------------|---------|---------|

- **npm**: v10.0.0 or higher| **Next.js** | 16.0.5 | React framework with App Router, Server Components, Turbopack |

- **PostgreSQL**: Database (or use Neon free tier)| **React** | 19.2.0 | UI library for component-based architecture |

- **Git**: For version control| **TypeScript** | 5.0+ | Type-safe JavaScript for reliability |

| **Tailwind CSS** | 4.x | Utility-first CSS framework |

### Required API Keys| **shadcn/ui** | Latest | Accessible component library (Radix UI primitives) |

| **Lucide React** | 0.552.0 | Icon library |

Sign up for these free services:| **Framer Motion** | 12.23.24 | Smooth animations |

| **Socket.io Client** | 4.8.1 | Real-time WebSocket client |

1. **Neon Database**: https://neon.tech (Free PostgreSQL)| **Emoji Picker React** | 4.16.1 | Emoji selection interface |

2. **Cloudinary**: https://cloudinary.com (Free image hosting)| **React Hook Form** | 7.66.0 | Form state management |

3. **OpenRouter**: https://openrouter.ai (AI API, $5 free credit)| **Zod** | 4.1.12 | Schema validation library |

4. **Google Cloud Console**: https://console.cloud.google.com (OAuth)| **Recharts** | 2.15.4 | Data visualization charts |

5. **reCAPTCHA**: https://www.google.com/recaptcha/admin (v2 Checkbox)| **React Beautiful DnD** | Latest | Drag-and-drop toolkit items |

6. **Gmail Account**: For SMTP email sending

### Backend

---

| Technology | Version | Purpose |

## ğŸš€ Installation|------------|---------|---------|

| **Next.js API Routes** | 16.0.5 | Serverless API endpoints |

### Step 1: Clone the Repository| **Prisma ORM** | 6.18.0 | Type-safe database client with auto-reconnect |

| **PostgreSQL** | Latest | Primary database (Neon serverless) |

```bash| **NextAuth.js** | 5.0-beta.30 | Authentication with JWT sessions |

git clone https://github.com/brittytino/podlink.git| **Socket.io Server** | 4.8.1 | WebSocket server (ports 3001, 3002) |

cd podlink| **Node.js** | 20+ | Server runtime environment |

```| **Cloudinary** | 2.8.0 | Image CDN and optimization |

| **Google Gemini API** | 2.0 Flash | Fallback AI (50/50 with OpenRouter) |

### Step 2: Install Dependencies| **OpenRouter API** | Latest | Primary AI generation (4 free models) |

| **bcryptjs** | 3.0.2 | Password hashing and verification |

```bash

npm install### Development Tools

```

| Tool | Version | Purpose |

### Step 3: Set Up Environment Variables|------|---------|---------|

| **ESLint** | 9.x | Code linting and quality |

```bash| **Concurrently** | 9.2.1 | Run multiple dev processes |

cp .env.example .env.local| **tsx** | 4.20.6 | TypeScript execution for scripts |

```| **Prisma Studio** | Built-in | Visual database editor |



Edit `.env.local` and fill in your credentials (see [Environment Variables](#-environment-variables)).---



### Step 4: Set Up Database## ğŸ“‹ Prerequisites



```bashBefore installation, ensure you have:

# Push database schema

npx prisma db push### Required Software

- **Node.js** v20.x or higher ([Download](https://nodejs.org/))

# (Optional) Seed with demo data- **npm** v9.x or higher (included with Node.js)

npm run db:seed- **Git** ([Download](https://git-scm.com/))

```

### Required Accounts & API Keys

### Step 5: Run the Application1. **Neon PostgreSQL** - Serverless PostgreSQL database

   - Sign up: [https://neon.tech/](https://neon.tech/)

```bash   - Create a new project and get connection string

npm run dev

```2. **Cloudinary** - Image hosting and CDN

   - Sign up: [https://cloudinary.com/](https://cloudinary.com/)

Open:   - Get: Cloud Name, API Key, API Secret

- **Frontend**: http://localhost:3000

- **Socket.IO**: http://localhost:30013. **Google Gemini API** - AI fallback (optional but recommended)

   - Get API key: [https://ai.google.dev/](https://ai.google.dev/)

---

4. **OpenRouter API** - Primary AI generation

## ğŸ” Environment Variables   - Sign up: [https://openrouter.ai/](https://openrouter.ai/)

   - Get API key (free tier available with 4 models)

Create `.env.local` file:

5. **Google OAuth** (optional for social login)

### Database   - Console: [https://console.cloud.google.com/](https://console.cloud.google.com/)

   - Create OAuth 2.0 credentials

```env

DATABASE_URL="postgresql://user:password@host.neon.tech/dbname?sslmode=require"### System Requirements

DIRECT_URL="postgresql://user:password@host.neon.tech/dbname?sslmode=require"- **RAM**: 4GB minimum, 8GB recommended

```- **Storage**: 500MB free space

- **Network**: Stable internet for real-time features

### NextAuth- **Ports**: 3000 (Next.js), 3001 (Socket.IO), 3002 (Socket.IO Emit Server)



```env---

NEXTAUTH_URL="http://localhost:3000"

NEXTAUTH_SECRET="your-secret-here"  # Generate: openssl rand -base64 32## ğŸ”§ Installation

```

### 1. Clone Repository

### Google OAuth

```bash

```envgit clone https://github.com/brittytino/podlink.git

GOOGLE_CLIENT_ID="your-client-id.apps.googleusercontent.com"cd podlink

GOOGLE_CLIENT_SECRET="your-client-secret"```

```

### 2. Install Dependencies

**Setup**:

1. Go to [Google Cloud Console](https://console.cloud.google.com/)```bash

2. Create OAuth Client IDnpm install

3. Add redirect URIs:```

   - `http://localhost:3000/api/auth/callback/google`

   - `https://yourdomain.com/api/auth/callback/google`This installs all required packages from `package.json` (frontend + backend dependencies).



### Cloudinary---



```env## ğŸŒ Environment Setup

CLOUDINARY_CLOUD_NAME="your-cloud-name"

CLOUDINARY_API_KEY="your-api-key"### 1. Create Environment File

CLOUDINARY_API_SECRET="your-api-secret"

CLOUDINARY_URL="cloudinary://api_key:api_secret@cloud_name"```bash

```cp .env.example .env

```

### OpenRouter AI

### 2. Configure Environment Variables

```env

OPENROUTER_API="sk-or-v1-your-api-key-here"Edit `.env` with your credentials:

```

```env

Get from: https://openrouter.ai# Database (Neon PostgreSQL)

DATABASE_URL="postgresql://user:password@host/database?sslmode=require"

### reCAPTCHADIRECT_URL="postgresql://user:password@host/database?sslmode=require"



```env# NextAuth Configuration

NEXT_PUBLIC_RECAPTCHA_SITE_KEY="your-site-key"NEXTAUTH_URL="http://localhost:3000"

RECAPTCHA_SECRET_KEY="your-secret-key"NEXTAUTH_SECRET="your-secure-random-string-here"

```# Generate with: openssl rand -base64 32



**Setup**:# Google OAuth (Optional)

1. Go to [reCAPTCHA Admin](https://www.google.com/recaptcha/admin)GOOGLE_CLIENT_ID="your-google-client-id"

2. Choose v2 "I'm not a robot" CheckboxGOOGLE_CLIENT_SECRET="your-google-client-secret"

3. Add domains: `localhost`, `yourdomain.com`

# Cloudinary (Required for image uploads)

### Email (SMTP)NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME="your-cloud-name"

NEXT_PUBLIC_CLOUDINARY_API_KEY="your-api-key"

```envCLOUDINARY_API_SECRET="your-api-secret"

SMTP_HOST="smtp.gmail.com"

SMTP_PORT="587"# AI APIs

SMTP_SECURE="false"GEMINI_API_KEY="your-gemini-api-key"

SMTP_USER="your-email@gmail.com"OPENROUTER_API_KEY="your-openrouter-api-key"

SMTP_PASSWORD="your-app-password"  # Generate in Gmail settings

SMTP_FROM="your-email@gmail.com"# Application URLs

```NEXT_PUBLIC_APP_URL="http://localhost:3000"

NEXT_PUBLIC_SOCKET_URL="http://localhost:3001"

### Socket.IO

# Socket.IO Ports (default: 3001, 3002)

```envSOCKET_PORT=3001

SOCKET_PORT="3001"EMIT_SERVER_PORT=3002

NEXT_PUBLIC_SOCKET_URL="http://localhost:3001"```

```

### 3. Generate NextAuth Secret

### Cron Security

```bash

```envopenssl rand -base64 32

CRON_SECRET="any-random-secret-string"  # Generate: openssl rand -hex 32```

```

Copy output to `NEXTAUTH_SECRET` in `.env`

---

---

## ğŸ—„ï¸ Database Setup

## ğŸ—„ï¸ Database Setup

### Commands

### 1. Verify Database Connection

```bash

# Generate Prisma ClientEnsure your Neon PostgreSQL database is active and `DATABASE_URL` is correct in `.env`.

npx prisma generate

### 2. Push Prisma Schema

# Push schema to database

npx prisma db push```bash

npx prisma db push

# Open Prisma Studio (GUI)```

npm run db:studio

This creates all tables, relations, and indexes in your database.

# Seed database

npm run db:seed### 3. Verify Schema

```

```bash

### Prisma Studionpx prisma studio

```

```bash

npm run db:studioOpens Prisma Studio at `http://localhost:5555` to view database tables.

```

### 4. Seed Database (Optional)

Opens at `http://localhost:5555` with visual database browser.

```bash

---npx prisma db seed

```

## ğŸƒ Running the Application

Populates database with:

### Development- Demo user accounts

- Sample pods

```bash- AI bot members

npm run dev- Initial check-ins

```

---

### Production

## â–¶ï¸ Running the Application

```bash

npm run build### Development Mode

npm start

``````bash

npm run dev

### Useful Scripts```



```bashThis starts **3 concurrent processes**:

npm run lint        # Lint code1. **Next.js Dev Server** - `http://localhost:3000` (Turbopack enabled)

npm run db:push     # Push schema2. **Socket.IO Main Server** - Port `3001` (real-time chat, presence)

npm run db:studio   # Open Prisma Studio3. **Socket.IO Emit Server** - Port `3002` (event broadcasting)

npm run db:seed     # Seed database

```### Production Build



---```bash

# Build optimized production bundle

## ğŸ“ Project Structurenpm run build



```# Start production server

podlink/npm start

â”œâ”€â”€ prisma/```

â”‚   â”œâ”€â”€ schema.prisma           # Database schema

â”‚   â”œâ”€â”€ seed.ts                 # Seeding script### Individual Process Commands

â”‚   â””â”€â”€ migrations/             # Migrations

â”œâ”€â”€ src/```bash

â”‚   â”œâ”€â”€ app/# Next.js only

â”‚   â”‚   â”œâ”€â”€ (auth)/             # Auth pages (login, register)npm run next-dev

â”‚   â”‚   â”œâ”€â”€ (protected)/        # Protected pages (dashboard, pod, profile)

â”‚   â”‚   â”œâ”€â”€ (public)/           # Public pages (about, privacy, terms)# Socket.IO servers only

â”‚   â”‚   â”œâ”€â”€ api/                # API routesnode server.mjs

â”‚   â”‚   â””â”€â”€ page.tsx            # Landing page```

â”‚   â”œâ”€â”€ components/             # React components

â”‚   â”‚   â”œâ”€â”€ auth/### Prisma Commands

â”‚   â”‚   â”œâ”€â”€ dashboard/

â”‚   â”‚   â”œâ”€â”€ pod/```bash

â”‚   â”‚   â”œâ”€â”€ ui/                 # shadcn/ui components# Generate Prisma Client (after schema changes)

â”‚   â”‚   â””â”€â”€ ...npx prisma generate

â”‚   â”œâ”€â”€ hooks/                  # Custom React hooks

â”‚   â”œâ”€â”€ lib/                    # Utilities and configs# Database migrations

â”‚   â”‚   â”œâ”€â”€ auth.ts             # NextAuth confignpx prisma migrate dev

â”‚   â”‚   â”œâ”€â”€ prisma.ts           # Prisma client

â”‚   â”‚   â”œâ”€â”€ socket.ts           # Socket.IO server# Reset database (WARNING: deletes all data)

â”‚   â”‚   â”œâ”€â”€ openrouter.ts       # AI clientnpx prisma migrate reset

â”‚   â”‚   â””â”€â”€ ...

â”‚   â””â”€â”€ types/                  # TypeScript types# Open Prisma Studio

â”œâ”€â”€ public/                     # Static assetsnpx prisma studio

â”œâ”€â”€ scripts/                    # Utility scripts```

â”œâ”€â”€ .env.local                  # Environment variables

â”œâ”€â”€ package.json## ğŸ“ Project Structure

â”œâ”€â”€ server.mjs                  # Socket.IO server

â””â”€â”€ README.md```

```podlink/

â”œâ”€â”€ prisma/                          # Database schema and migrations

---â”‚   â”œâ”€â”€ schema.prisma               # Prisma data models (User, Pod, Message, etc.)

â”‚   â”œâ”€â”€ seed.ts                     # Database seeding script

## ğŸ“¡ API Documentationâ”‚   â””â”€â”€ migrations/                 # Migration history

â”‚

### Authenticationâ”œâ”€â”€ public/                          # Static assets

â”‚   â”œâ”€â”€ badge-icons/                # Achievement badge images

| Endpoint | Method | Description |â”‚   â””â”€â”€ *.svg                       # Public icons

|----------|--------|-------------|â”‚

| `/api/auth/register` | POST | Create account |â”œâ”€â”€ scripts/                         # Utility scripts

| `/api/auth/[...nextauth]` | * | NextAuth endpoints |â”‚   â”œâ”€â”€ check-streak-data.ts        # Streak data validation

| `/api/auth/verify-email` | GET | Verify email token |â”‚   â”œâ”€â”€ fix-streak-data.ts          # Streak repair utility

â”‚   â”œâ”€â”€ reset-ai-streaks.ts         # Reset AI bot streaks

### Pod Systemâ”‚   â””â”€â”€ test-streak-system.ts       # Streak system testing

â”‚

| Endpoint | Method | Description |â”œâ”€â”€ server.mjs                       # Socket.IO server (ports 3001, 3002)

|----------|--------|-------------|â”‚

| `/api/pods/my-pod` | GET | Get current pod |â”œâ”€â”€ src/

| `/api/pods/messages` | GET | Get chat messages |â”‚   â”œâ”€â”€ middleware.ts               # NextAuth + protected route middleware

| `/api/pods/messages` | POST | Send message |â”‚   â”‚

â”‚   â”œâ”€â”€ app/                         # Next.js App Router

### Gamificationâ”‚   â”‚   â”œâ”€â”€ layout.tsx              # Root layout with SessionProvider

â”‚   â”‚   â”œâ”€â”€ page.tsx                # Landing page

| Endpoint | Method | Description |â”‚   â”‚   â”‚

|----------|--------|-------------|â”‚   â”‚   â”œâ”€â”€ (auth)/                 # Authentication routes (guest only)

| `/api/check-ins/submit` | POST | Submit check-in |â”‚   â”‚   â”‚   â”œâ”€â”€ login/              # Login page

| `/api/streak/current` | GET | Get streak |â”‚   â”‚   â”‚   â””â”€â”€ register/           # Registration page

| `/api/leaderboard` | GET | Get rankings |â”‚   â”‚   â”‚

â”‚   â”‚   â”œâ”€â”€ (protected)/            # Protected routes (auth required)

### Crisis Toolsâ”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/          # User dashboard with stats

â”‚   â”‚   â”‚   â”œâ”€â”€ pod/                # Pod chat interface

| Endpoint | Method | Description |â”‚   â”‚   â”‚   â”œâ”€â”€ profile/            # User profile management

|----------|--------|-------------|â”‚   â”‚   â”‚   â”œâ”€â”€ leaderboard/        # Global rankings

| `/api/toolkit/ai-chat` | POST | AI companion |â”‚   â”‚   â”‚   â”œâ”€â”€ onboarding/         # Multi-step onboarding

| `/api/toolkit/notify-pod` | POST | Alert pod |â”‚   â”‚   â”‚   â””â”€â”€ crisis-toolkit/     # Personal crisis toolkit

â”‚   â”‚   â”‚

---â”‚   â”‚   â”œâ”€â”€ (public)/               # Public marketing pages

â”‚   â”‚   â”‚   â”œâ”€â”€ about/              # About page

## ğŸš€ Deploymentâ”‚   â”‚   â”‚   â”œâ”€â”€ features/           # Features showcase

â”‚   â”‚   â”‚   â”œâ”€â”€ privacy/            # Privacy policy

### Vercel (Recommended)â”‚   â”‚   â”‚   â”œâ”€â”€ terms/              # Terms of service

â”‚   â”‚   â”‚   â””â”€â”€ ...                 # Other public pages

1. **Push to GitHub**â”‚   â”‚   â”‚

2. **Import to Vercel**: https://vercel.comâ”‚   â”‚   â””â”€â”€ api/                     # API Routes (serverless functions)

3. **Add Environment Variables**â”‚   â”‚       â”œâ”€â”€ auth/               # NextAuth endpoints

4. **Deploy!**â”‚   â”‚       â”œâ”€â”€ pods/               # Pod CRUD operations

â”‚   â”‚       â”œâ”€â”€ check-ins/          # Check-in system

### Post-Deploymentâ”‚   â”‚       â”œâ”€â”€ streak/             # Streak management

â”‚   â”‚       â”œâ”€â”€ notifications/      # Crisis alerts

- Update `NEXTAUTH_URL` to production domainâ”‚   â”‚       â”œâ”€â”€ leaderboard/        # Rankings API

- Add production URL to Google OAuth redirect URIsâ”‚   â”‚       â”œâ”€â”€ profile/            # User profile updates

- Update reCAPTCHA domainsâ”‚   â”‚       â”œâ”€â”€ help/               # Crisis response (OpenRouter AI)

- Set up Vercel Cron for streak resetâ”‚   â”‚       â”œâ”€â”€ toolkit/            # Crisis toolkit CRUD

â”‚   â”‚       â”œâ”€â”€ socket/             # Socket.IO connection

### Vercel Cronâ”‚   â”‚       â””â”€â”€ cron/               # Scheduled jobs

â”‚   â”‚

Add to `vercel.json`:â”‚   â”œâ”€â”€ components/                  # React components

â”‚   â”‚   â”œâ”€â”€ LandingPage.tsx         # Marketing landing page

```jsonâ”‚   â”‚   â”œâ”€â”€ SessionProvider.tsx     # NextAuth context provider

{â”‚   â”‚   â”œâ”€â”€ auth/                   # Login/Register forms

  "crons": [{â”‚   â”‚   â”œâ”€â”€ dashboard/              # Dashboard widgets

    "path": "/api/cron/reset-streaks",â”‚   â”‚   â”œâ”€â”€ pod/                    # Chat components

    "schedule": "0 0 * * *"â”‚   â”‚   â”œâ”€â”€ profile/                # Profile components

  }]â”‚   â”‚   â”œâ”€â”€ leaderboard/            # Ranking tables

}â”‚   â”‚   â”œâ”€â”€ onboarding/             # Onboarding steps

```â”‚   â”‚   â”œâ”€â”€ toolkit/                # Crisis toolkit components

â”‚   â”‚   â”œâ”€â”€ landing/                # Landing page sections

---â”‚   â”‚   â””â”€â”€ ui/                     # shadcn/ui primitives

â”‚   â”‚

## ğŸ¤ Contributingâ”‚   â”œâ”€â”€ hooks/                       # Custom React hooks

â”‚   â”‚   â”œâ”€â”€ useAuth.ts              # Authentication hook

Contributions are welcome! Please:â”‚   â”‚   â”œâ”€â”€ useSocket.ts            # Socket.IO hook

â”‚   â”‚   â”œâ”€â”€ usePodMessages.ts       # Chat messages hook

1. Fork the repositoryâ”‚   â”‚   â”œâ”€â”€ use-toast.ts            # Toast notifications

2. Create a feature branchâ”‚   â”‚   â””â”€â”€ use-mobile.ts           # Mobile detection

3. Make your changesâ”‚   â”‚

4. Submit a pull requestâ”‚   â”œâ”€â”€ lib/                         # Core libraries and utilities

â”‚   â”‚   â”œâ”€â”€ prisma.ts               # Prisma client with auto-reconnect

### Reporting Bugsâ”‚   â”‚   â”œâ”€â”€ auth.ts                 # NextAuth configuration

â”‚   â”‚   â”œâ”€â”€ socket.ts               # Socket.IO client setup

Create an issue with:â”‚   â”‚   â”œâ”€â”€ socket-emit.ts          # Socket.IO emit server

- Clear descriptionâ”‚   â”‚   â”œâ”€â”€ openrouter.ts           # OpenRouter API integration

- Steps to reproduceâ”‚   â”‚   â”œâ”€â”€ gemini.ts               # Google Gemini API (fallback)

- Expected vs actual behaviorâ”‚   â”‚   â”œâ”€â”€ cloudinary.ts           # Image upload handler

- Screenshots (if applicable)â”‚   â”‚   â”œâ”€â”€ content-moderation.ts   # AI + keyword moderation

â”‚   â”‚   â”œâ”€â”€ streak-manager.ts       # Streak calculation logic

---â”‚   â”‚   â”œâ”€â”€ streak-reset.ts         # Streak reset handler

â”‚   â”‚   â”œâ”€â”€ pod-matching.ts         # Pod assignment algorithm

## ğŸ“„ Licenseâ”‚   â”‚   â”œâ”€â”€ pod-assignment.ts       # User-to-pod matching

â”‚   â”‚   â”œâ”€â”€ pod-names.ts            # Dynamic pod name generation (OpenRouter)

This project is licensed under the **MIT License** - see the [LICENSE](LICENSE) file for details.â”‚   â”‚   â”œâ”€â”€ ai-bot-names.ts         # AI bot name list

â”‚   â”‚   â”œâ”€â”€ ai-responses.ts         # AI response templates

**MIT License Summary:**â”‚   â”‚   â”œâ”€â”€ goal-categories.ts      # Goal category definitions

- âœ… Commercial useâ”‚   â”‚   â””â”€â”€ utils.ts                # Shared utility functions

- âœ… Modificationâ”‚   â”‚

- âœ… Distributionâ”‚   â”œâ”€â”€ types/                       # TypeScript type definitions

- âœ… Private useâ”‚   â”‚   â”œâ”€â”€ index.ts                # Shared types (User, Pod, Message, etc.)

â”‚   â”‚   â”œâ”€â”€ next-auth.d.ts          # NextAuth type extensions

---â”‚   â”‚   â””â”€â”€ socket.ts               # Socket.IO event types

â”‚   â”‚

## ğŸ’¬ Supportâ”‚   â””â”€â”€ styles/                      # Global styles

â”‚

- ğŸ“§ Email: brittytino08@gmail.comâ”œâ”€â”€ .env                             # Environment variables (git-ignored)

- ğŸ› Issues: [GitHub Issues](https://github.com/brittytino/podlink/issues)â”œâ”€â”€ package.json                     # Dependencies and scripts

- ğŸ“– Documentation: This READMEâ”œâ”€â”€ tsconfig.json                    # TypeScript configuration

â”œâ”€â”€ next.config.js                   # Next.js configuration

### FAQâ”œâ”€â”€ tailwind.config.ts               # Tailwind CSS configuration

â”œâ”€â”€ components.json                  # shadcn/ui configuration

**Q: OAuth 401 error?**  â”œâ”€â”€ prisma/schema.prisma             # Database schema

A: Add redirect URI to Google Console, wait 5 min, clear cacheâ””â”€â”€ README.md                        # This file

```

**Q: Database connection error?**  

A: Check `DATABASE_URL`, run `npx prisma db push`### Key Files Explained



**Q: Socket.IO not connecting?**  | File | Purpose |

A: Check ports 3001/3002, verify `NEXT_PUBLIC_SOCKET_URL`|------|---------|

| `server.mjs` | Standalone Socket.IO server for real-time features (chat, presence, alerts) |

**Q: Images not uploading?**  | `src/middleware.ts` | Protects routes, redirects unauthenticated users |

A: Verify Cloudinary credentials, check file size limits| `src/lib/prisma.ts` | Prisma client with `ensureConnection()` auto-reconnect logic |

| `src/lib/openrouter.ts` | OpenRouter API wrapper for AI generation (primary) |

---| `src/lib/gemini.ts` | Google Gemini API wrapper (fallback, 50/50 for chat) |

| `src/lib/content-moderation.ts` | AI + keyword-based content filtering |

## ğŸ™ Acknowledgments| `src/lib/pod-names.ts` | Dynamic pod name generation via OpenRouter |

| `src/app/api/help/route.ts` | Crisis response API with AI-generated messages |

- [Next.js](https://nextjs.org/) - React framework| `src/app/(protected)/pod/page.tsx` | Main pod chat interface with online/offline status |

- [Prisma](https://www.prisma.io/) - Database ORM| `prisma/schema.prisma` | Complete database schema (22 models) |

- [Neon](https://neon.tech/) - Serverless Postgres

- [Socket.IO](https://socket.io/) - Real-time engine---

- [OpenRouter](https://openrouter.ai/) - AI APInpm run build

- [Cloudinary](https://cloudinary.com/) - Media management

- [shadcn/ui](https://ui.shadcn.com/) - UI components# Start production servers

- [Tailwind CSS](https://tailwindcss.com/) - CSS framework## ğŸ”Œ API Documentation



---### Core API Endpoints



## ğŸ“Š Project Status#### Authentication (`/api/auth/*`)



- **Version**: 0.1.0 (Beta)```typescript

- **Status**: Active Development// Register new user

- **Last Updated**: December 2025POST /api/auth/register

- **Maintainer**: [Brittytino](https://github.com/brittytino)Body: { email, username, password, fullName }

Response: { success: true, message: "User created" }

---

// NextAuth endpoints (handled by NextAuth.js)

## ğŸ—ºï¸ RoadmapPOST /api/auth/callback/credentials  // Login

GET  /api/auth/callback/google       // Google OAuth

### v0.2.0 (Q1 2025)GET  /api/auth/session               // Get current session

- [ ] Mobile app (React Native)POST /api/auth/signout               // Logout

- [ ] Push notifications```

- [ ] Stripe integration

- [ ] Advanced analytics#### Pods (`/api/pods/*`)

- [ ] Voice/video calls

```typescript

### v0.3.0 (Q2 2025)// Get pod members with online status

- [ ] Multi-language supportGET /api/pods/members?podId={uuid}

- [ ] Achievement badgesResponse: { members: User[], onlineUsers: string[] }

- [ ] Mentor matching

- [ ] Admin dashboard// Send message to pod (with content moderation)

POST /api/pods/messages

---Body: {

  podId: string

<div align="center">  userId: string

  messageText: string

### â­ Star this repo if you find it helpful!  imageUrl?: string

  isCrisisResponse?: boolean

**Built with â¤ï¸ by [Brittytino](https://github.com/brittytino)**}

Response: { success: true, message: Message }

[Report Bug](https://github.com/brittytino/podlink/issues) Â· [Request Feature](https://github.com/brittytino/podlink/issues) Â· [Contribute](https://github.com/brittytino/podlink/pulls)// 400 Error if content violates moderation rules



</div>// Upload image (Cloudinary)

POST /api/pods/messages/upload-image
Body: FormData with 'image' field (max 5MB)
Response: { success: true, imageUrl: string }

// React to message
POST /api/pods/messages/react
Body: { messageId: string, userId: string, emoji: string }

// Report message (auto-deletes after 3 reports)
POST /api/pods/messages/report
Body: { messageId: string, userId: string, reason: string }
```

#### Check-Ins (`/api/check-ins/*`)

```typescript
// Create daily check-in (timezone-aware)
POST /api/check-ins/create
Body: { userId: string, timezone: string }
Response: { success: true, currentStreak: number }

// Get check-in history
GET /api/check-ins/history?userId={uuid}&days={number}
Response: { checkIns: CheckIn[], currentStreak: number }

// Get check-in stats
GET /api/check-ins/stats?userId={uuid}
Response: {
  totalCheckIns: number
  currentStreak: number
  longestStreak: number
  weeklyProgress: number[]
}
```

#### Streaks (`/api/streak/*`)

```typescript
// Restore streak (1 per month)
POST /api/streak/restore
Body: { userId: string }
Response: { success: true, restoredStreak: number }
// 400 Error if already used this month

// Check restoration eligibility
GET /api/streak/can-restore?userId={uuid}
Response: { canRestore: boolean, lastUsed: Date | null }
```

#### Crisis Support (`/api/alerts/*`, `/api/help/*`)

```typescript
// Create crisis alert (broadcasts to pod)
POST /api/alerts/create
Body: {
  userId: string
  podId: string
  customMessage?: string
}
Response: { success: true, alert: CrisisAlert }
// Triggers Socket.IO 'crisis-alert' event

// Resolve crisis alert
POST /api/alerts/resolve
Body: { alertId: string }
Response: { success: true }

// Get AI crisis response (OpenRouter API)
POST /api/help
Body: {
  userId: string
  message?: string
  context?: { goal: string, streak: number, inCrisis: boolean }
}
Response: { success: true, response: string }
// AI-generated supportive message based on user context
```

#### Crisis Toolkit (`/api/toolkit/*`)

```typescript
// Get user's toolkit items
GET /api/toolkit/items?userId={uuid}
Response: { items: ToolkitItem[] }

// Create toolkit item
POST /api/toolkit/items
Body: { userId: string, title: string, description: string, order: number }

// Update toolkit item order (drag-drop)
PUT /api/toolkit/items/reorder
Body: { items: { id: string, order: number }[] }

// Delete toolkit item
DELETE /api/toolkit/items/{itemId}
```

#### Leaderboard (`/api/leaderboard/*`)

```typescript
// Get top pods by total streak
GET /api/leaderboard/pods?limit={number}
Response: {
  pods: { id: string, name: string, totalStreak: number, members: number }[]
}

// Get top users by current streak
GET /api/leaderboard/users?limit={number}
Response: {
  users: { id: string, displayName: string, currentStreak: number, avatar: string }[]
}
```

#### Profile (`/api/profile/*`)

```typescript
// Update user profile
PUT /api/profile/update
Body: {
  userId: string
  displayName?: string
  avatar?: string
  timezone?: string
  availability?: string[]
}
Response: { success: true, user: User }

// Upload avatar (Cloudinary)
POST /api/profile/upload-avatar
Body: FormData with 'avatar' field (max 2MB)
Response: { success: true, avatarUrl: string }
```

#### Onboarding (`/api/onboarding/*`)

```typescript
// Complete onboarding (assigns pod)
POST /api/onboarding/complete
Body: {
  userId: string
  goalType: "QUIT_HABIT" | "BUILD_HABIT"
  goalCategory: string
  goalDescription: string
  availability: string[]
  timezone: string
}
Response: {
  success: true
  pod: Pod
  displayName: string  // AI-generated via OpenRouter
}
```

---

### Socket.IO Events

#### Client â†’ Server Events

```typescript
// Join pod room
socket.emit('join-pod', { podId, userId, displayName })

// Send typing indicator
socket.emit('typing', { podId, userId, displayName })

// Stop typing indicator
socket.emit('stop-typing', { podId, userId })

// Send message (also triggers HTTP POST for persistence)
socket.emit('send-message', { podId, userId, messageText, imageUrl })

// Send crisis alert
socket.emit('crisis-alert', { podId, userId, message })

// Disconnect
socket.emit('disconnect')
```

#### Server â†’ Client Events

```typescript
// Receive new message
socket.on('receive-message', (message: Message) => { ... })

// User is typing (max 3 users shown)
socket.on('typing', ({ userId, displayName }) => { ... })

## ğŸ¤– AI Integration

### OpenRouter API (Primary)

PodLink uses **OpenRouter** as the primary AI provider for dynamic content generation.

#### Available Free Models

1. **Google Gemini 2.0 Flash Exp** (`google/gemini-2.0-flash-exp:free`)
   - Best for: General responses, creative content
   - Speed: Very fast
   - Context: 1M tokens

2. **Meta Llama 3.2 3B Instruct** (`meta-llama/llama-3.2-3b-instruct:free`)
   - Best for: Concise responses
   - Speed: Fast
   - Context: 128k tokens

3. **Microsoft Phi-3 Mini** (`microsoft/phi-3-mini-128k-instruct:free`)
   - Best for: Quick responses
   - Speed: Very fast
   - Context: 128k tokens

4. **Qwen 2 7B Instruct** (`qwen/qwen-2-7b-instruct:free`)
   - Best for: Multilingual support
   - Speed: Fast
   - Context: 32k tokens

#### Use Cases

```typescript
// 1. Display Name Generation (OpenRouter)
// Temperature: 0.9 (creative)
// Model: Randomly selected from 4 free models
const displayName = await generateDisplayName(goalCategory, goalDescription)
// Example: "Phoenix Rising" for quit smoking goal

// 2. Pod Name Generation (OpenRouter)
// Temperature: 0.9 (creative)
// Context: Goal category-specific prompts
const podName = await generatePodName(goalCategory, goalType)
// Example: "The Mindful Warriors" for meditation pod

// 3. Crisis Response (OpenRouter)
// Temperature: 0.7 (balanced)
// Context: User's streak, goal, crisis state
const response = await generateAIResponse(userContext)
// Example: "I see you're struggling, [Name]. Your 15-day streak shows real strength..."

// 4. Content Moderation (OpenRouter)
// Temperature: 0.1 (strict, deterministic)
// Detects: Racial slurs, profanity, hate speech, harassment
const isOffensive = await moderateContent(messageText)
// Blocks message before sending if offensive
```

### Google Gemini API (Fallback)

Gemini 2.0 Flash is used as a **50/50 hybrid** for chat messages alongside OpenRouter.

```typescript
// Chat AI Bot Responses (50% Gemini, 50% OpenRouter)
// Provides diversity in AI-generated pod messages
// Temperature: 0.7
const botMessage = Math.random() > 0.5
  ? await generateGeminiResponse(context)
  : await generateOpenRouterResponse(context)
```

### AI Generation Configuration

#### Environment Variables

```env
# Required for all AI features
OPENROUTER_API_KEY="sk-or-v1-..."

# Optional fallback (recommended)
GEMINI_API_KEY="AIzaSy..."
```

#### Model Selection Logic

```typescript
// src/lib/openrouter.ts
const OPENROUTER_MODELS = [
  'google/gemini-2.0-flash-exp:free',
  'meta-llama/llama-3.2-3b-instruct:free',
  'microsoft/phi-3-mini-128k-instruct:free',
  'qwen/qwen-2-7b-instruct:free'
]

// Random model selection for load balancing
const model = OPENROUTER_MODELS[Math.floor(Math.random() * OPENROUTER_MODELS.length)]
```

### Content Moderation Flow

```
User sends message
       â†“
AI Analysis (OpenRouter, temp 0.1)
       â†“
Keyword Pattern Check (20+ patterns)
       â†“
   Offensive?
    /     \
  Yes      No
   â†“        â†“
400 Error  Save to DB â†’ Socket.IO Broadcast
```

**Moderation Rules:**
- Racial slurs (critical severity) â†’ Instant block
- Profanity (high severity) â†’ Instant block
- Hate speech â†’ Instant block
- Harassment â†’ Instant block
- Message reports (3 reports) â†’ Auto-delete

---

## ğŸš€ Deployment

### Vercel Deployment (Recommended)

#### 1. Prerequisites
- Vercel account ([Sign up](https://vercel.com/))
- GitHub repository with PodLink code
- All environment variables ready

#### 2. Deploy Steps

```bash
# Install Vercel CLI
npm i -g vercel

# Login to Vercel
vercel login

# Deploy to production
vercel --prod
```

#### 3. Configure Environment Variables

In Vercel Dashboard â†’ Settings â†’ Environment Variables, add:

```
DATABASE_URL
DIRECT_URL
NEXTAUTH_URL (https://your-domain.vercel.app)
NEXTAUTH_SECRET
GOOGLE_CLIENT_ID
GOOGLE_CLIENT_SECRET
NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME
NEXT_PUBLIC_CLOUDINARY_API_KEY
CLOUDINARY_API_SECRET
GEMINI_API_KEY
OPENROUTER_API_KEY
NEXT_PUBLIC_APP_URL (https://your-domain.vercel.app)
NEXT_PUBLIC_SOCKET_URL (https://socket-server.your-domain.com)
```

#### 4. Deploy Socket.IO Server Separately

**Option A: Railway** ([railway.app](https://railway.app/))
```bash
# railway.json
{
  "build": {
    "builder": "NIXPACKS"
  },
  "deploy": {
    "startCommand": "node server.mjs"
  }
}
```

**Option B: Render** ([render.com](https://render.com/))
```yaml
# render.yaml
services:
  - type: web
    name: podlink-socket
    env: node
    buildCommand: npm install
    startCommand: node server.mjs
    envVars:
      - key: PORT
        value: 3001
```

**Option C: Fly.io** ([fly.io](https://fly.io/))
```bash
fly launch
fly deploy
```

#### 5. Update CORS in `server.mjs`

```javascript
const io = new Server(server, {
  cors: {
    origin: [
      'http://localhost:3000',
      'https://your-domain.vercel.app'  // Add production domain
    ],
    methods: ['GET', 'POST'],
    credentials: true
  }
})
```

### Environment-Specific Configuration

#### Production Checklist

- [ ] Set `NODE_ENV=production`
- [ ] Use connection pooling for Neon database
- [ ] Enable Cloudinary auto-optimization
- [ ] Configure proper CORS origins
- [ ] Set up error tracking (Sentry, LogRocket)
- [ ] Enable rate limiting on API routes
- [ ] Configure CSP headers in `next.config.js`
- [ ] Set up SSL certificates (auto with Vercel)
- [ ] Configure domain DNS records
- [ ] Test all Socket.IO events in production

#### Database Migration for Production

```bash
# Generate migration
npx prisma migrate dev --name production_init

# Deploy migration to production
npx prisma migrate deploy

# Verify with Prisma Studio
npx prisma studio
```

---

## âš ï¸ Troubleshooting

### Common Issues & Solutions

#### 1. Prisma "Engine is not yet connected" Error

**Symptom:** 500 errors on API routes, database queries fail

**Solution:**
```typescript
// Already implemented in src/lib/prisma.ts
const ensureConnection = async () => {
  if (!isConnected) {
    await prisma.$connect()
    isConnected = true
  }
}

// Auto-reconnect with retry logic (3 attempts, progressive delays)
```

**Verification:**
```bash
# Check database connection
npx prisma db pull

# Test connection
curl http://localhost:3000/api/test-db
```

---

#### 2. Socket.IO Connection Failed

**Symptom:** Chat not updating, "Connecting..." status stuck

**Solution:**
```bash
# Kill existing Socket.IO processes
lsof -ti:3001 | xargs kill -9
lsof -ti:3002 | xargs kill -9

# Restart servers
npm run dev
```

**Check ports:**
```bash
# Verify Socket.IO is running
lsof -i :3001
lsof -i :3002

# Test Socket.IO endpoint
curl http://localhost:3001/socket.io/
```

**CORS Issues:**
```javascript
// server.mjs - Verify origin matches
origin: ['http://localhost:3000']  // Must match NEXT_PUBLIC_APP_URL
```

---

#### 3. Content Moderation Not Blocking Messages

**Symptom:** Offensive words bypass moderation, still appear in chat

**Solution:**
- Check `OPENROUTER_API_KEY` is set in `.env`
- Verify keyword patterns in `src/lib/content-moderation.ts`
- Test moderation endpoint:

```bash
curl -X POST http://localhost:3000/api/pods/messages \
  -H "Content-Type: application/json" \
  -d '{"messageText":"test offensive word","podId":"...","userId":"..."}'

# Should return 400 error if offensive
```

**Force re-check:**
```typescript
// src/lib/content-moderation.ts
// Lower AI temperature for stricter moderation
temperature: 0.1  // Already set (very strict)
```

---

#### 4. Online/Offline Status Not Updating

**Symptom:** Users show offline when they're online, or vice versa

**Solution:**
```typescript
// src/app/(protected)/pod/page.tsx
// Verify socket listeners are set up
useEffect(() => {
  socket.on('online-users', (users) => setOnlineUsers(new Set(users)))
  socket.on('user-online', (userId) => setOnlineUsers(prev => new Set([...prev, userId])))
  socket.on('user-offline', (userId) => {
    setOnlineUsers(prev => {
      const updated = new Set(prev)
      updated.delete(userId)
      return updated
    })
  })
}, [])
```

**Check Socket.IO logs:**
```bash
# server.mjs should log:
# "User {userId} joined pod {podId}"
# "Broadcasting online users: [...]"
```

---

#### 5. OpenRouter API Errors

**Symptom:** AI-generated names not working, 500 errors on `/api/help`

**Solution:**
```bash
# Verify API key
echo $OPENROUTER_API_KEY

# Test OpenRouter endpoint
curl https://openrouter.ai/api/v1/chat/completions \
  -H "Authorization: Bearer $OPENROUTER_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"model":"google/gemini-2.0-flash-exp:free","messages":[{"role":"user","content":"test"}]}'
```

**Fallback to Gemini:**
```typescript
// src/lib/pod-names.ts
// If OpenRouter fails, uses Gemini automatically
catch (error) {
  console.error('OpenRouter failed, using Gemini:', error)
  return await generateWithGemini(...)
}
```

---

#### 6. Build Errors

**Symptom:** `npm run build` fails with TypeScript errors

**Solution:**
```bash
# Clear cache and rebuild
rm -rf .next node_modules
npm install
npm run build

# Check for type errors
npx tsc --noEmit

# Fix common issues
npx prisma generate  # Regenerate Prisma Client
```

**Specific Error Fixes:**
```typescript
// "Cannot find module 'prisma/client'"
npx prisma generate

// "Type 'X' is not assignable to type 'Y'"
// Check src/types/index.ts for type definitions

// "Module not found: Can't resolve 'socket.io-client'"
npm install socket.io-client@4.8.1
```

---

#### 7. Port Already in Use

**Symptom:** `EADDRINUSE: address already in use :::3000`

**Solution:**
```bash
# Find process using port
lsof -ti:3000

# Kill process
lsof -ti:3000 | xargs kill -9

# Or use different port
PORT=3001 npm run dev
```

---

#### 8. Database Connection Timeout (Neon)

**Symptom:** "Connection timed out" or "Too many connections"

**Solution:**
```env
# Use connection pooling
DATABASE_URL="postgresql://user:pass@host-pooler:5432/db?pgbouncer=true"
DIRECT_URL="postgresql://user:pass@host:5432/db"
```

**Neon-specific settings:**
```typescript
// prisma/schema.prisma
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")  // For migrations
}
```

---

#### 9. Image Upload Fails (Cloudinary)

**Symptom:** 500 error on `/api/pods/messages/upload-image`

**Solution:**
```bash
# Verify Cloudinary credentials
curl -X POST https://api.cloudinary.com/v1_1/{CLOUD_NAME}/image/upload \
  -F "file=@test.jpg" \
  -F "api_key={API_KEY}" \
  -F "timestamp={TIMESTAMP}" \
  -F "signature={SIGNATURE}"
```

**Check file size:**
```typescript
// Max 5MB for chat images, 2MB for avatars
if (file.size > 5 * 1024 * 1024) {
  return res.status(400).json({ error: 'File too large' })
}
```

---

#### 10. Streak Not Updating

**Symptom:** Check-in successful but streak stays at 0

**Solution:**
```bash
# Run streak fix script
npx tsx scripts/fix-streak-data.ts

# Check streak data
npx tsx scripts/check-streak-data.ts

# Reset AI bot streaks (if needed)
npx tsx scripts/reset-ai-streaks.ts
```

**Manual verification:**
```bash
# Open Prisma Studio
npx prisma studio

# Check CheckIn table for user
# Verify lastSuccessfulDay matches timezone
```

---

### Getting Help

If issues persist:

1. **Check logs:**
   ```bash
   # Next.js logs
   npm run dev

   # Socket.IO logs
   node server.mjs
   ```

2. **Enable debug mode:**
   ```env
   DEBUG=socket.io*
   NODE_ENV=development
   ```

3. **Consult documentation:**
   - [Next.js Docs](https://nextjs.org/docs)
   - [Prisma Docs](https://www.prisma.io/docs)
   - [Socket.IO Docs](https://socket.io/docs)
   - [OpenRouter API Docs](https://openrouter.ai/docs)

4. **Report bugs:**
   - GitHub Issues: [github.com/brittytino/podlink/issues](https://github.com/brittytino/podlink/issues)
   - Include: Error logs, steps to reproduce, environment details

---

## ğŸ“ License

MIT License - see [LICENSE](LICENSE) file for details

---

## ğŸ‘¤ Author

**Britty Tino**
- GitHub: [@brittytino](https://github.com/brittytino)
- Project: [PodLink](https://github.com/brittytino/podlink)

---

## ğŸ™ Acknowledgments

- **Next.js Team** - Amazing React framework
- **Vercel** - Hosting and deployment platform
- **Prisma** - Type-safe ORM
- **Neon** - Serverless PostgreSQL
- **OpenRouter** - Free AI model access
- **Google** - Gemini AI API
- **Cloudinary** - Image CDN
- **shadcn/ui** - Beautiful accessible components
- **Socket.IO** - Real-time communication
- **All contributors** who helped build PodLink

---

<p align="center">
  <strong>Built with â¤ï¸ for mental health and personal growth</strong>
</p>

<p align="center">
  <a href="#-overview">Back to Top â†‘</a>
</p>

### Test Database Connection

```bash
npm run db:test
```

---

## ğŸš¢ Deployment

### Deploy to Vercel (Recommended)

1. **Install Vercel CLI**
   ```bash
   npm i -g vercel
   vercel login
   vercel
   ```

2. **Configure Environment Variables** in Vercel Dashboard

3. **Deploy Socket.io Server** separately (Render/Railway)

4. **Update Socket Connection URL**
   ```env
   NEXT_PUBLIC_SOCKET_URL=https://your-socket-server.onrender.com
   ```

---

## ğŸ¤ Contributing

We welcome contributions! Please:

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Submit a pull request

---

## ğŸ“„ License

MIT License - see LICENSE file for details.

---

## ğŸ“ Support & Contact

- ğŸ“§ Email: support@podlink.example.com
- ğŸ’¬ Discord: [Join our community](https://discord.gg/podlink)
- ğŸ¦ Twitter: [@PodLinkApp](https://twitter.com/podlinkapp)

---

## ğŸ™ Acknowledgements

- **Next.js** - React framework
- **Prisma** - Database ORM
- **Socket.io** - Real-time communication
- **shadcn/ui** - UI components
- **Neon** - Serverless PostgreSQL
- **Cloudinary** - Image management
- **Google Gemini** - AI capabilities

---

<div align="center">

**Made with â¤ï¸ by the PodLink Team**

â­ Star us on GitHub!

</div>
